#!/usr/bin/env bash

FULLPATH="$( cd "$(dirname "$0")" ; pwd -P )"
BASEPATH="${FULLPATH}/../.."

# see https://docs.datastax.com/en/archived/cassandra/2.1/cassandra/operations/ops_tune_jvm_c.html

MYSQL_USER="root" \
MYSQL_PWD="4E3Gd0F0Eokf576P" \
MYSQL_DB="dist" \
MYSQL_CONN_NUM="900" \
MAX_WORK_ID="5000000" \
MEMCACHED_MEM="3072" \
KAFKA_JVM_MEM="6G" \
KAFKA_TOPIC="work-topic" \
KAFKA_PARTITIONS="20" \
CAS_JVM_MEM="10G" \
CAS_HEAP_SIZE="8G" \
CAS_HEAP_NEWSIZE="600M" \
ES_JVM_MEM="6G" \
GRAFANA_USER="admin" \
GRAFANA_PWD="4E3Gd0F0Eokf576P" \
API_GET_WORK_PERCENTAGE_COUNT="4500" \
API_UPDATE_VIEWED_PERCENTAGE_COUNT="2500" \
API_GET_ACHIEVEMENT_PERCENTAGE_COUNT="2500" \
API_PLAN_WORK_PERCENTAGE_COUNT="500" \
CONSUMER_FACTOR="37" \
HOST_IP_CLIENT="192.168.3.111" \
HOST_IP_STORAGE="192.168.3.111" \
HOST_IP_KAFKA_1="192.168.3.111" \
HOST_IP_KAFKA_2="192.168.3.111" \
HOST_IP_ES_1="192.168.3.111" \
HOST_IP_ES_2="192.168.3.111" \
HOST_IP_MONITOR="127.0.0.1" \
HOST_IP_WEB="192.168.3.111" \
HOST_IP_SERVICE="192.168.3.111" \
GRAFANA_API="eyJrIjoiUkhTVDhDWDM2VWdxQW81MTQ1cjdLWklDSnoxTUZjcDIiLCJuIjoiY2x1c3RlciIsImlkIjoxfQ==" \
GRAFANA_START="1562493600000" \
GRAFANA_END="1562495400000" \
GRAFANA_WIDTH="1000" \
GRAFANA_HEIGHT="500" \
GRAFANA_TIMEZONE="Asia/Shanghai" \
STRESS_CONNECTIONS="10000" \
STRESS_DURATION="30s" \
STRESS_RATE="10/s" \
STRESS_TIMEOUT="30s" \
STRESS_WORKERS="1000" \
node build/index.js "$@"